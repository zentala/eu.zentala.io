document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("algolia-search-input"),n=document.getElementById("algolia-search-results"),i=document.getElementById("search-results-list"),d=document.getElementById("search-loading"),o=document.getElementById("search-no-results"),m=document.getElementById("close-search-btn");if(!t||!n||!i||!d||!o||!m){console.error("Search elements not found");return}const h={search:async(e,s)=>({hits:[]})};let a=null;const r=(e,s)=>{if(!s.trim())return e;try{const c=new RegExp(`(${s.trim().replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return e.replace(c,'<span class="search-highlight">$1</span>')}catch{return e}},g=(e,s)=>{if(i.innerHTML="",e.length===0){o.classList.remove("hidden");return}o.classList.add("hidden"),e.forEach(c=>{const l=document.createElement("div");l.className="search-result-item";const v=r(c.title||"Untitled",s),u=c.description?r(c.description,s):c.excerpt?r(c.excerpt,s):"";l.innerHTML=`
          <a href="${c.slug}" class="block">
            <div class="search-result-title">${v}</div>
            ${u?`<div class="search-result-description">${u}</div>`:""}
            <div class="search-result-path">${c.slug}</div>
          </a>
        `,i.appendChild(l)})},L=async e=>{if(!e.trim()){n.classList.add("hidden");return}n.classList.remove("hidden"),i.innerHTML="",d.classList.remove("hidden"),o.classList.add("hidden");try{const{hits:s}=await h.search(e,{attributesToRetrieve:["title","description","excerpt","slug"],hitsPerPage:10});d.classList.add("hidden"),g(s,e)}catch(s){console.error("Error searching:",s),d.classList.add("hidden"),o.classList.remove("hidden")}};t.addEventListener("input",e=>{const c=e.target.value.trim();if(a&&clearTimeout(a),!c){n.classList.add("hidden");return}a=setTimeout(()=>{L(c)},300)}),t.addEventListener("keydown",e=>{if(e.key==="Enter"){e.preventDefault();const s=e.target.value.trim();s&&(window.location.href=`/search?q=${encodeURIComponent(s)}`)}}),t.addEventListener("focus",()=>{t.value.trim()&&n.classList.remove("hidden")}),document.addEventListener("click",e=>{e.target instanceof Node&&!t.contains(e.target)&&!n.contains(e.target)&&n.classList.add("hidden")}),m.addEventListener("click",()=>{n.classList.add("hidden")}),document.addEventListener("keydown",e=>{e.key==="Escape"&&n.classList.add("hidden")})});document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("mobile-menu-button"),n=document.getElementById("mobile-menu");t&&n&&t.addEventListener("click",()=>{n.classList.toggle("hidden")})});window.addEventListener("scroll",function(){const t=document.querySelector("#header .container");t&&(window.scrollY>50?(t.classList.add("py-2"),t.classList.remove("py-4")):(t.classList.add("py-4"),t.classList.remove("py-2")))});document.addEventListener("DOMContentLoaded",()=>{if(window.location.hostname==="localhost"||window.location.hostname.includes("127.0.0.1")||window.location.hostname.includes(".local")){const n=document.querySelectorAll("footer .grid > div:nth-child(3) ul")[0];if(n){const i=document.createElement("li"),d=document.createElement("a");d.href="/ui",d.className="hover:underline transition-colors",d.style.color="var(--color-text-secondary)",d.textContent="UI Demo",i.appendChild(d),n.appendChild(i)}}});document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("theme-toggle");t&&t.addEventListener("click",()=>{const n=document.documentElement.classList.toggle("dark");localStorage.setItem("theme",n?"dark":"light")})});
